{% extends "base.html.twig" %}

{% block head %}
    {{ parent() }}
    
    <!-- Fallback Bootstrap local -->
    <script>
        // Vérifier si Bootstrap CSS est chargé
        function checkBootstrapCSS() {
            const bootstrapCSS = document.querySelector('link[href*="bootstrap"]');
            if (!bootstrapCSS || !bootstrapCSS.sheet) {
                console.warn('Bootstrap CSS non chargé, utilisation du fallback local');
                loadLocalBootstrapCSS();
            }
        }
        
        // Vérifier si Bootstrap JS est chargé
        function checkBootstrapJS() {
            if (typeof bootstrap === 'undefined') {
                console.warn('Bootstrap JS non chargé, utilisation du fallback local');
                loadLocalBootstrapJS();
            }
        }
        
        // Charger Bootstrap CSS local
        function loadLocalBootstrapCSS() {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '/assets/css/bootstrap.min.css';
            link.onerror = function() {
                console.error('Impossible de charger Bootstrap CSS local');
                // CSS de secours minimal
                const fallbackCSS = `
                    .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
                    .row { display: flex; flex-wrap: wrap; margin: 0 -15px; }
                    .col { flex: 1; padding: 0 15px; }
                    .btn { display: inline-block; padding: 8px 16px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; border: none; cursor: pointer; }
                    .btn:hover { background: #0056b3; }
                    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1050; }
                    .modal.show { display: block; }
                    .modal-dialog { position: relative; width: auto; margin: 10px; }
                    .modal-content { background: white; border-radius: 6px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
                    .modal-header { padding: 15px; border-bottom: 1px solid #dee2e6; }
                    .modal-body { padding: 15px; }
                    .modal-footer { padding: 15px; border-top: 1px solid #dee2e6; }
                    .close { float: right; font-size: 1.5rem; font-weight: 700; line-height: 1; color: #000; background: transparent; border: 0; cursor: pointer; }
                `;
                const style = document.createElement('style');
                style.textContent = fallbackCSS;
                document.head.appendChild(style);
            };
            document.head.appendChild(link);
        }
        
        // Charger Bootstrap JS local
        function loadLocalBootstrapJS() {
            const script = document.createElement('script');
            script.src = '/assets/js/bootstrap.min.js';
            script.onerror = function() {
                console.error('Impossible de charger Bootstrap JS local');
                // JS de secours minimal
                window.bootstrap = {
                    Modal: function(element) {
                        this.element = element;
                        this.show = function() { element.classList.add('show'); };
                        this.hide = function() { element.classList.remove('show'); };
                    },
                    Toast: function(element) {
                        this.element = element;
                        this.show = function() { 
                            element.style.display = 'block';
                            setTimeout(() => element.style.display = 'none', 5000);
                        };
                    }
                };
            };
            document.head.appendChild(script);
        }
        
        // Vérifications au chargement
        document.addEventListener('DOMContentLoaded', function() {
            checkBootstrapCSS();
            checkBootstrapJS();
        });
    </script>
{% endblock %}