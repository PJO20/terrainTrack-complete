{% extends "base.html.twig" %}

{% block title %}Exemple d'utilisation des Permissions - TerrainTrack{% endblock %}

{% block content %}
<div class="container">
    <h1>Exemples d'utilisation des permissions dans Twig</h1>

    <!-- V√©rification d'une permission simple -->
    {% if hasPermission('interventions.create') %}
        <div class="alert alert-success">
            ‚úÖ Vous avez la permission de cr√©er des interventions
        </div>
    {% else %}
        <div class="alert alert-warning">
            ‚ö†Ô∏è Vous n'avez pas la permission de cr√©er des interventions
        </div>
    {% endif %}

    <!-- V√©rification d'acc√®s √† un module -->
    {% if canAccessModule('interventions') %}
        <div class="alert alert-success">
            ‚úÖ Vous pouvez acc√©der au module interventions
        </div>
    {% endif %}

    <!-- V√©rification d'actions CRUD -->
    <div class="permissions-demo">
        <h3>Actions disponibles :</h3>
        <ul>
            {% if canPerformAction('interventions', 'create') %}
                <li>‚úÖ Cr√©er des interventions</li>
            {% endif %}
            
            {% if canPerformAction('interventions', 'read') %}
                <li>‚úÖ Consulter des interventions</li>
            {% endif %}
            
            {% if canPerformAction('interventions', 'update') %}
                <li>‚úÖ Modifier des interventions</li>
            {% endif %}
            
            {% if canPerformAction('interventions', 'delete') %}
                <li>‚úÖ Supprimer des interventions</li>
            {% endif %}
        </ul>
    </div>

    <!-- V√©rification de permissions multiples -->
    {% if hasAnyPermission(['interventions.create', 'interventions.update']) %}
        <div class="alert alert-info">
            ‚ÑπÔ∏è Vous pouvez cr√©er ou modifier des interventions
        </div>
    {% endif %}

    {% if hasAllPermissions(['interventions.read', 'interventions.create']) %}
        <div class="alert alert-success">
            ‚úÖ Vous avez toutes les permissions n√©cessaires pour g√©rer les interventions
        </div>
    {% endif %}

    <!-- V√©rification du statut administrateur -->
    {% if isAdmin() %}
        <div class="alert alert-primary">
            üëë Vous √™tes administrateur
        </div>
    {% endif %}

    {% if isSuperAdmin() %}
        <div class="alert alert-warning">
            üöÄ Vous √™tes super administrateur
        </div>
    {% endif %}

    <!-- Affichage des permissions de l'utilisateur -->
    <div class="user-permissions">
        <h3>Vos permissions par module :</h3>
        {% set userPermissions = getUserPermissionsByModule() %}
        {% for module, permissions in userPermissions %}
            <div class="module-permissions">
                <h4>{{ module|title }}</h4>
                <ul>
                    {% for permission in permissions %}
                        <li>{{ permission }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>

    <!-- Affichage des r√¥les de l'utilisateur -->
    <div class="user-roles">
        <h3>Vos r√¥les :</h3>
        {% set userRoles = getUserRoles() %}
        {% if userRoles|length > 0 %}
            <ul>
                {% for role in userRoles %}
                    <li>{{ role.displayName }} - {{ role.description }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Aucun r√¥le assign√©</p>
        {% endif %}
    </div>

    <!-- Exemple d'affichage conditionnel de boutons -->
    <div class="action-buttons">
        <h3>Boutons d'action :</h3>
        
        {% if hasPermission('interventions.create') %}
            <button class="btn btn-primary">Nouvelle Intervention</button>
        {% endif %}
        
        {% if hasPermission('interventions.update') %}
            <button class="btn btn-secondary">Modifier</button>
        {% endif %}
        
        {% if hasPermission('interventions.delete') %}
            <button class="btn btn-danger">Supprimer</button>
        {% endif %}
        
        {% if isAdmin() %}
            <button class="btn btn-warning">Administration</button>
        {% endif %}
    </div>

    <!-- Exemple de menu conditionnel -->
    <div class="navigation-menu">
        <h3>Menu de navigation :</h3>
        <nav>
            <ul>
                {% if canAccessModule('dashboard') %}
                    <li><a href="/dashboard">Tableau de bord</a></li>
                {% endif %}
                
                {% if canAccessModule('interventions') %}
                    <li><a href="/interventions">Interventions</a></li>
                {% endif %}
                
                {% if canAccessModule('vehicles') %}
                    <li><a href="/vehicles">V√©hicules</a></li>
                {% endif %}
                
                {% if canAccessModule('teams') %}
                    <li><a href="/teams">√âquipes</a></li>
                {% endif %}
                
                {% if canAccessModule('reports') %}
                    <li><a href="/reports">Rapports</a></li>
                {% endif %}
                
                {% if isAdmin() %}
                    <li><a href="/permissions/admin">Administration</a></li>
                {% endif %}
            </ul>
        </nav>
    </div>
</div>

<style>
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
}

.alert {
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.alert-success {
    background: #d1fae5;
    color: #065f46;
    border: 1px solid #a7f3d0;
}

.alert-warning {
    background: #fef3c7;
    color: #92400e;
    border: 1px solid #fde68a;
}

.alert-info {
    background: #dbeafe;
    color: #1e40af;
    border: 1px solid #bfdbfe;
}

.alert-primary {
    background: #dbeafe;
    color: #1e40af;
    border: 1px solid #bfdbfe;
}

.permissions-demo {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 8px;
    margin: 1.5rem 0;
}

.module-permissions {
    background: #f8fafc;
    padding: 1rem;
    border-radius: 8px;
    margin: 1rem 0;
}

.action-buttons {
    margin: 2rem 0;
}

.btn {
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
}

.btn-primary {
    background: #2563eb;
    color: #fff;
}

.btn-secondary {
    background: #6b7280;
    color: #fff;
}

.btn-danger {
    background: #dc2626;
    color: #fff;
}

.btn-warning {
    background: #f59e0b;
    color: #fff;
}

.navigation-menu nav ul {
    list-style: none;
    padding: 0;
}

.navigation-menu nav ul li {
    margin-bottom: 0.5rem;
}

.navigation-menu nav ul li a {
    color: #2563eb;
    text-decoration: none;
    padding: 0.5rem;
    display: block;
    border-radius: 4px;
    transition: background 0.2s;
}

.navigation-menu nav ul li a:hover {
    background: #f3f4f6;
}
</style>
{% endblock %} 